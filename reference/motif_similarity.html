<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compare motifs from segregated sequences — motif_similarity • MotifPeeker</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare motifs from segregated sequences — motif_similarity"><meta name="description" content="Compute motif similarity scores between motifs discovered from segregated
sequences. Wrapper around compare_motifs to
compare motifs from different groups of sequences. To see the possible
similarity measures available, refer to details."><meta property="og:description" content="Compute motif similarity scores between motifs discovered from segregated
sequences. Wrapper around compare_motifs to
compare motifs from different groups of sequences. To see the possible
similarity measures available, refer to details."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotifPeeker</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotifPeeker.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/docker.html">Docker/Singularity Containers</a></li>
    <li><a class="dropdown-item" href="../articles/examples.html">Example Reports</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/neurogenomics/MotifPeeker/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compare motifs from segregated sequences</h1>
      <small class="dont-index">Source: <a href="https://github.com/neurogenomics/MotifPeeker/blob/master/R/motif_similarity.R" class="external-link"><code>R/motif_similarity.R</code></a></small>
      <div class="d-none name"><code>motif_similarity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute motif similarity scores between motifs discovered from segregated
sequences. Wrapper around <code><a href="https://rdrr.io/pkg/universalmotif/man/compare_motifs.html" class="external-link">compare_motifs</a></code> to
compare motifs from different groups of sequences. To see the possible
similarity measures available, refer to details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">motif_similarity</span><span class="op">(</span></span>
<span>  <span class="va">streme_out</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"PCC"</span>,</span>
<span>  normalise.scores <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-streme-out">streme_out<a class="anchor" aria-label="anchor" href="#arg-streme-out"></a></dt>
<dd><p>Output from <code><a href="denovo_motifs.html">denovo_motifs</a></code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>character(1)</code> One of PCC, EUCL, SW, KL, ALLR, BHAT, HELL,
SEUCL, MAN, ALLR_LL, WEUCL, WPCC. See details.</p></dd>


<dt id="arg-normalise-scores">normalise.scores<a class="anchor" aria-label="anchor" href="#arg-normalise-scores"></a></dt>
<dd><p><code>logical(1)</code> Favour alignments which leave fewer
unaligned positions, as well as alignments between motifs of similar length.
Similarity scores are multiplied by the ratio of
aligned positions to the total number of positions in the larger motif,
and the inverse for distance scores.</p></dd>


<dt id="arg-bpparam">BPPARAM<a class="anchor" aria-label="anchor" href="#arg-bpparam"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/BiocParallel/man/BiocParallelParam-class.html" class="external-link">BiocParallelParam-class</a></code> object
specifying run parameters. (default = bpparam())</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/universalmotif/man/compare_motifs.html" class="external-link">universalmotif::compare_motifs</a></code></p><dl><dt><code>motifs</code></dt>
<dd><p>See <code><a href="https://rdrr.io/pkg/universalmotif/man/convert_motifs.html" class="external-link">convert_motifs()</a></code> for acceptable motif formats.</p></dd>

    <dt><code>compare.to</code></dt>
<dd><p><code>numeric</code> If missing, compares all motifs to all other motifs.
Otherwise compares all motifs to the specified motif(s).</p></dd>

    <dt><code>db.scores</code></dt>
<dd><p><code>data.frame</code> or <code>DataFrame</code>. See <code>details</code>.</p></dd>

    <dt><code>use.freq</code></dt>
<dd><p><code>numeric(1)</code>. For comparing the <code>multifreq</code> slot.</p></dd>

    <dt><code>use.type</code></dt>
<dd><p><code>character(1)</code> One of <code>'PPM'</code> and <code>'ICM'</code>.
The latter allows for taking into account the background
frequencies if <code>relative_entropy = TRUE</code>. Note that <code>'ICM'</code> is not
allowed when <code>method = c("ALLR", "ALLR_LL")</code>.</p></dd>

    <dt><code>tryRC</code></dt>
<dd><p><code>logical(1)</code> Try the reverse complement of the motifs as well,
report the best score.</p></dd>

    <dt><code>min.overlap</code></dt>
<dd><p><code>numeric(1)</code> Minimum overlap required when aligning the
motifs. Setting this to a number higher then the width of the motifs
will not allow any overhangs. Can also be a number between 0 and 1,
representing the minimum fraction that the motifs must overlap.</p></dd>

    <dt><code>min.mean.ic</code></dt>
<dd><p><code>numeric(1)</code> Minimum mean information content between the
two motifs for an alignment to be scored. This helps prevent scoring
alignments between low information content regions of two motifs. Note that
this can result in some comparisons failing if no alignment passes the
mean IC threshold. Use <code><a href="https://rdrr.io/pkg/universalmotif/man/utils-motif.html" class="external-link">average_ic()</a></code> to filter out low IC motifs to get around
this if you want to avoid getting <code>NA</code>s in your output.</p></dd>

    <dt><code>min.position.ic</code></dt>
<dd><p><code>numeric(1)</code> Minimum information content required between
individual alignment positions for it to be counted in the final alignment
score. It is recommended to use this together with <code>normalise.scores = TRUE</code>,
as this will help punish scores resulting from only a fraction of an
alignment.</p></dd>

    <dt><code>relative_entropy</code></dt>
<dd><p><code>logical(1)</code> Change the ICM calculation affecting
<code>min.position.ic</code> and <code>min.mean.ic</code>. See <code><a href="https://rdrr.io/pkg/universalmotif/man/convert_type.html" class="external-link">convert_type()</a></code>.</p></dd>

    <dt><code>max.p</code></dt>
<dd><p><code>numeric(1)</code> Maximum P-value allowed in reporting matches.
Only used if <code>compare.to</code> is set.</p></dd>

    <dt><code>max.e</code></dt>
<dd><p><code>numeric(1)</code> Maximum E-value allowed in reporting matches.
Only used if <code>compare.to</code> is set. The E-value is the P-value multiplied
by the number of input motifs times two.</p></dd>

    <dt><code>nthreads</code></dt>
<dd><p><code>numeric(1)</code> Run <code><a href="https://rdrr.io/pkg/universalmotif/man/compare_motifs.html" class="external-link">compare_motifs()</a></code> in parallel with <code>nthreads</code>
threads. <code>nthreads = 0</code> uses all available threads.</p></dd>

    <dt><code>score.strat</code></dt>
<dd><p><code>character(1)</code> How to handle column scores calculated from
motif alignments. "sum": add up all scores. "a.mean": take the arithmetic
mean. "g.mean": take the geometric mean. "median": take the median.
"wa.mean", "wg.mean": weighted arithmetic/geometric mean. "fzt": Fisher
Z-transform. Weights are the
total information content shared between aligned columns.</p></dd>

    <dt><code>output.report</code></dt>
<dd><p><code>character(1)</code> Provide a filename for <code><a href="https://rdrr.io/pkg/universalmotif/man/compare_motifs.html" class="external-link">compare_motifs()</a></code>
to write an html ouput report to. The top matches are shown alongside
figures of the match alignments. This requires the <code>knitr</code> and <code>rmarkdown</code>
packages. (Note: still in development.)</p></dd>

    <dt><code>output.report.max.print</code></dt>
<dd><p><code>numeric(1)</code> Maximum number of top matches to
print.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of matrices containing the similarity scores between motifs
from different groups of sequences. The order of comparison is as follows,
with first element representing the rows and second element representing the
columns of the matrix:</p><ul><li><p>1. <strong>Common motifs comparison:</strong> Common seqs from reference
    (1) &lt;-&gt; comparison (2)</p></li>
<li><p>2. <strong>Unique motifs comparison:</strong> Unique seqs from reference
    (1) &lt;-&gt; comparison (2)</p></li>
<li><p>3. <strong>Cross motifs comparison 1:</strong> Unique seqs from reference
    (1) &lt;-&gt; comparison (1)</p></li>
<li><p>4. <strong>Cross motifs comparison 2:</strong> Unique seqs from comparison
    (2) &lt;-&gt; reference (1)</p></li>
</ul><p>The list is repeated for each set of comparison groups in input.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="available-metrics">Available metrics<a class="anchor" aria-label="anchor" href="#available-metrics"></a></h3>


<p>The following metrics are available:</p><ul><li><p>Euclidean distance (<code>EUCL</code>) (Choi et al. 2004)</p></li>
<li><p>Weighted Euclidean distance (<code>WEUCL</code>)</p></li>
<li><p>Kullback-Leibler divergence (<code>KL</code>) (Kullback and Leibler 1951; Roepcke et al. 2005)</p></li>
<li><p>Hellinger distance (<code>HELL</code>) (Hellinger 1909)</p></li>
<li><p>Squared Euclidean distance (<code>SEUCL</code>)</p></li>
<li><p>Manhattan distance (<code>MAN</code>)</p></li>
<li><p>Pearson correlation coefficient (<code>PCC</code>)</p></li>
<li><p>Weighted Pearson correlation coefficient (<code>WPCC</code>)</p></li>
<li><p>Sandelin-Wasserman similarity (<code>SW</code>), or sum of squared distances (Sandelin and Wasserman 2004)</p></li>
<li><p>Average log-likelihood ratio (<code>ALLR</code>) (Wang and Stormo 2003)</p></li>
<li><p>Lower limit ALLR (<code>ALLR_LL</code>) (Mahony et al. 2007)</p></li>
<li><p>Bhattacharyya coefficient (<code>BHAT</code>) (Bhattacharyya 1943)</p></li>
</ul><p>Comparisons are calculated between two motifs at a time. All possible alignments
are scored, and the best score is reported. In an alignment scores are calculated
individually between columns. How those scores are combined to generate the final
alignment scores depends on <code>score.strat</code>.</p>
<p>See the "Motif comparisons and P-values" vignette for a description of the
various metrics. Note that <code>PCC</code>, <code>WPCC</code>, <code>SW</code>, <code>ALLR</code>, <code>ALLR_LL</code> and <code>BHAT</code>
are similarities;
higher values mean more similar motifs. For the remaining metrics, values closer
to zero represent more similar motifs.</p>
<p>Small pseudocounts are automatically added when one of the following methods
is used: <code>KL</code>, <code>ALLR</code>, <code>ALLR_LL</code>, <code>IS</code>. This is avoid
zeros in the calculations.</p>
</div>

<div class="section">
<h3 id="calculating-p-values">Calculating P-values<a class="anchor" aria-label="anchor" href="#calculating-p-values"></a></h3>


<p>To note regarding p-values: P-values are pre-computed using the
<code><a href="https://rdrr.io/pkg/universalmotif/man/make_DBscores.html" class="external-link">make_DBscores()</a></code> function. If not given, then uses a set of internal
precomputed P-values from the JASPAR2018 CORE motifs. These precalculated
scores are dependent on the length of the motifs being compared. This takes
into account that comparing small motifs with larger motifs leads to higher
scores, since the probability of finding a higher scoring alignment is
higher.</p>
<p>The default P-values have been precalculated for regular DNA motifs. They
are of little use for motifs with a different number of alphabet letters
(or even the <code>multifreq</code> slot).</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">memes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/memes/man/meme_is_installed.html" class="external-link">meme_is_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"CTCF_TIP_peaks"</span>, package <span class="op">=</span> <span class="st">"MotifPeeker"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"CTCF_ChIP_peaks"</span>, package <span class="op">=</span> <span class="st">"MotifPeeker"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BSgenome.Hsapiens.UCSC.hg38"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">genome_build</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>            <span class="fu">BSgenome.Hsapiens.UCSC.hg38</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BSgenome.Hsapiens.UCSC.hg38/man/package.html" class="external-link">BSgenome.Hsapiens.UCSC.hg38</a></span></span></span>
<span class="r-in"><span>        <span class="va">segregated_peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="segregate_seqs.html">segregate_seqs</a></span><span class="op">(</span><span class="va">CTCF_TIP_peaks</span>, <span class="va">CTCF_ChIP_peaks</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">denovo_motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="denovo_motifs.html">denovo_motifs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">segregated_peaks</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            trim_seq_width <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>                            genome_build <span class="op">=</span> <span class="va">genome_build</span>,</span></span>
<span class="r-in"><span>                            discover_motifs_count <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                            filter_n <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>                            maxw <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                            minw <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                            out_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">similarity_matrices</span> <span class="op">&lt;-</span> <span class="fu">motif_similarity</span><span class="op">(</span><span class="va">denovo_motifs</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">similarity_matrices</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                m01_YGCCCYCTRSTGGCMRV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m01_GAGGDSARAS             0.2258419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   m01_CMYCTRSTGGYY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m01_TGASCTCHADWGW        0.4360961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   m01_YGCCCYCTRSTGGCMRV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m01_TGASCTCHADWGW             0.4128632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  m01_GAGGDSARAS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m01_CMYCTRSTGGYY      0.2843023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hiranyamaya Dash, Thomas Roberts, Maria Weinert, Nathan Skene.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

